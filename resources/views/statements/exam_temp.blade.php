<div id="print-content" style="display: none">
    <h4 class="text-center">
        Ведомость учета успеваемости студентов № 315434
    </h4>
    <div class="row">
        <div class="col-md-12" style="font-size: 0.8em">
            <div class="row">
                <div class="col-md-3">
                    <span>Преподаватель: <span>Мышов А.С.</span></span>
                </div>
                <div class="col-md-3">
                    <span>Курс: <span>4</span></span>

                </div>
                <div class="col-md-6">
                    <span>Дисциплина: <span>Компьютерные сети и телекоммуникации</span></span>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <span>Кафедра: <span>СКС</span></span>
                </div>
                <div class="col-md-3">
                    <span>Семестр: <span>7</span></span>

                </div>
                <div class="col-md-6">
                    <span>Количество часов: <span>72</span></span>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <span>Группа: <span>СКС-17</span></span>

                </div>
                <div class="col-md-3">
                    <span>Учебный год: <span>2020-2021</span></span>
                </div>
                <div class="col-md-6">
                    <span>Статус: <span><b>Закрыта</b></span></span>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-1">
        <h5>Экзамен</h5>
    </div>

    <div class="row">
        <div class="col-md-12">
            <table border="1" style="text-align: center; font-size: 0.9em">
                <thead>
                    <tr>
                        <td rowspan="2">№</td>
                        <td rowspan="2">Ф.И.О.</td>
                        <td rowspan="2">Зачетная книжка</td>
                        <td rowspan="2">Оценка в процентах</td>
                        <td rowspan="2">Оценка</td>
                        <td rowspan="2">Итог</td>
                        <td rowspan="2">Подпись преподавателя</td>
                        <td colspan="2">Дополнительная пересдача</td>
                        <td colspan="2">Первая пересдача</td>
                        <td colspan="2">Вторая пересдача</td>
                        <td rowspan="2">Итог</td>
                    </tr>
                    <tr>
                        <td>Результат</td>
                        <td>Дата</td>
                        <td>Результат</td>
                        <td>Дата</td>
                        <td>Результат</td>
                        <td>Дата</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Мышов А.С.</td>
                        <td>3-1231-15</td>
                        <td>2</td>
                        <td>Неуд</td>
                        <td>Н/я</td>
                        <td></td>
                        <td>Н/я</td>
                        <td>19.01.2020</td>
                        <td>Н/я</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                        <td>20.20.2020</td>
                        <td>Зачет</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script type="text/javascript">
    $('#toolbar').w2toolbar({
        name: 'toolbar',
        items: [
            { type: 'button', id: 'refresh', text: 'Обновить', icon: 'fas fa-redo' },
            { type: 'button', id: 'save', text: 'Сохранить', icon: 'fas fa-save' },
            { type: 'button', id: 'print', text: 'Печать', icon: 'fas fa-print' },
            { type: 'break' },
            { type: 'radio', id: 'unlock', group: '1', text: 'Открыть', icon: 'fas fa-lock-open', checked: true },
            { type: 'radio', id: 'lock', group: '1', text: 'Закрыть', icon: 'fas fa-lock' },
        ],
        onClick: function (event) {
            switch(event.target){
                case('print'):
                    this.print();
                    break;
            }
            // console.log('Target: '+ event.target, event);
        },
        print: function(){
            let windowPrint = window.open('http://' + location.host + '/pr.html');

            windowPrint.onload = function() {
                var doc = windowPrint.document;

                var newDiv = doc.createElement("div");
                document.getElementById('print-content').style.display = 'block'
                newDiv.innerHTML = document.getElementById('print-content').innerHTML;
                doc.body.appendChild(newDiv);
            };

            windowPrint.print();

            windowPrint.onafterprint = function(event) {
                windowPrint.close();
                document.getElementById('print-content').style.display = 'none';
            }
        }
    });

    var data = [
        {
                    recid: 1,
                    user_id: 1,
                    full_name: 'Мышов А.С.',
                    record_book_number: '321435',
                    score_date: '10.02.2022',
                    percent_score: '95',
                    start_total: 'отл',
                    additional_retake_score: '96',
                    additional_retake_date: '10.02.2022',
                    first_retake_score: '98',
                    first_retake_date: '10.02.2022',
                    second_retake_score: '99',
                    second_retake_date: '10.02.2022',
                    final_total: 'отл'
                },
        {
                    recid: 2,
                    user_id: 2,
                    full_name: 'Мышов А.С.',
                    record_book_number: '321435',
                    score_date: '10.02.2022',
                    percent_score: '95',
                    start_total: 'отл',
                    additional_retake_score: '96',
                    additional_retake_date: '10.02.2022',
                    first_retake_score: '98',
                    first_retake_date: '10.02.2022',
                    second_retake_score: '99',
                    second_retake_date: '10.02.2022',
                    final_total: 'отл'
        },
        {
            recid: 3,
            user_id: 3,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
        {
            recid: 4,
            user_id: 4,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
        {
            recid: 5,
            user_id: 5,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
        {
            recid: 6,
            user_id: 6,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
        {
            recid: 7,
            user_id: 7,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
        {
            recid: 8,
            user_id: 8,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
        {
            recid: 9,
            user_id: 9,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
        {
            recid: 10,
            user_id: 10,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
        {
            recid: 11,
            user_id: 11,
            full_name: 'Мышов А.С.',
            record_book_number: '321435',
            score_date: '10.02.2022',
            percent_score: '95',
            start_total: 'отл',
            additional_retake_score: '96',
            additional_retake_date: '10.02.2022',
            first_retake_score: '98',
            first_retake_date: '10.02.2022',
            second_retake_score: '99',
            second_retake_date: '10.02.2022',
            final_total: 'отл'
        },
    ];

    $(function () {
        $('#grid').w2grid({
            name: 'grid',
            columnGroups: [
                { text: '', span: 1 },
                { text: '', span: 1 },
                { text: '', span: 1 },
                { text: '', span: 1 },
                { text: '', span: 1 },
                { text: '', span: 1 },
                { text: '', span: 1 },
                { text: 'Дополнительная пересдача', span: 2 },
                { text: 'Первая пересдача', span: 2 },
                { text: 'Вторая пересдача', span: 2 }
            ],
            columns: [
                { field: 'user_id', text: '№', size: '30px', resizable: true, style: 'border: 1px solid #d2d1d1;',},
                { field: 'full_name', text: 'Ф.И.О.', size: '150px', sortable: true, resizable: true, style: 'border: 1px solid #d2d1d1;',},
                { field: 'record_book_number', text: 'Зачетная книжка', size: '120px', style: 'border: 1px solid #d2d1d1;', resizable: true, attr: "align=center"},
                { field: 'score_date', text: 'Дата получения оценки', size: '100px', style: 'background: #efe; border: 1px solid #d2d1d1;', resizable: true, attr: "align=center", editable: { type: 'date', format: 'dd.mm.yyyy' }},
                { field: 'percent_score', text: 'Оценка в процентах', size: '80px', style: 'background: #efe; border: 1px solid #d2d1d1;', sortable: true, resizable: true, attr: "align=center", editable: { type: 'int', min: 60, max: 100 }},
                { field: 'start_total', text: 'Итог', size: '60px', sortable: true, attr: "align=center", style: 'border: 1px solid #d2d1d1;', resizable: true},
                { field: 'teacher_signature', text: 'Подпись преподавателя', size: '150px', style: 'border: 1px solid #d2d1d1;', resizable: true},
                { field: 'additional_retake_score', text: 'Результат', size: '60px', style: 'background: #efe; border: 1px solid #d2d1d1;', sortable: true, attr: "align=center", resizable: true, editable: { type: 'int', min: 60, max: 100 }},
                { field: 'additional_retake_date', text: 'Дата', size: '100px', style: 'background: #efe; border: 1px solid #d2d1d1;', sortable: true, attr: "align=center", resizable: true, editable: { type: 'date', format: 'dd.mm.yyyy' }},
                { field: 'first_retake_score', text: 'Результат', size: '60px', style: 'background: #efe; border: 1px solid #d2d1d1;', sortable: true, attr: "align=center", resizable: true, editable: { type: 'int', min: 60, max: 100 }},
                { field: 'first_retake_date', text: 'Дата', size: '100px', style: 'background: #efe; border: 1px solid #d2d1d1;', sortable: true, attr: "align=center", resizable: true, editable: { type: 'date', format: 'dd.mm.yyyy' }},
                { field: 'second_retake_score', text: 'Результат', size: '60px' , style: 'background: #efe; border: 1px solid #d2d1d1;', sortable: true, attr: "align=center", resizable: true, editable: { type: 'int', min: 60, max: 100 }},
                { field: 'second_retake_date', text: 'Дата', size: '100px', style: 'background: #efe; border: 1px solid #d2d1d1;', sortable: true, attr: "align=center", resizable: true, editable: { type: 'date', format: 'dd.mm.yyyy' }},
                { field: 'final_total', text: 'Итог', size: '60px', style: 'border: 1px solid #d2d1d1;', sortable: true, attr: "align=center", resizable: true},
            ],
            // toolbar: {
            //     items: [
            //         { id: 'add', type: 'button', text: 'Add Record', icon: 'w2ui-icon-plus' },
            //         { id: 'test', type: 'button', text: 'Add Record', icon: 'w2ui-icon-plus' }
            //     ],
            //     onClick: function (event) {
            //         if (event.target == 'add') {
            //             w2ui.grid.add({ recid: w2ui.grid.records.length + 1 });
            //         }
            //         if (event.target == 'test') {
            //             console.log('123');
            //         }
            //     }
            // },
            records: data,
            onChange: function(event) {
                console.log(event.column, event.index, event.value_new, event.value_original);
            }
        });
    });

    function showChanged() {
        w2popup.open({
            title: 'Records Changes',
            with: 600,
            height: 550,
            body: `<pre>${JSON.stringify(w2ui['grid'].getChanges(), null, 4)}</pre>`,
            buttons: '<button class="w2ui-btn" onclick="w2popup.close()">Ok</button>'
        })
    }
</script>
